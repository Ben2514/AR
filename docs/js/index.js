(()=>{"use strict";window.cameraOK=!1,window.studentName="",window.studentID="",window.currentQ=0,window.record=function(){let e=[];for(let t=0;t<numQ;t++)e.push([]);return e}(),function(){let e=new bootstrap.Modal(document.querySelector("#starter")),t=document.querySelector("#starter-form");t.addEventListener("submit",(function(r){t.classList.add("was-validated"),r.preventDefault(),r.stopPropagation(),t.checkValidity()&&(window.studentName=document.querySelector("#studentName").value,window.studentID=document.querySelector("#studentID").value,e.hide(),cameraOK&&(document.querySelector(".arjs-loader").style.display="none"))}),!1),e.show()}(),window.addEventListener("camera-init",(()=>{document.querySelector("#toggle").style.display="",document.querySelector("#commit").style.display="",cameraOK=!0,0!==studentName.length&&0!==studentID.length&&(document.querySelector(".arjs-loader").style.display="none")})),document.querySelectorAll("a-marker").forEach((e=>{e.addEventListener("markerFound",(e=>{!function(e){currentQ&&document.querySelector(`#exam${currentQ}`).classList.remove("active");let t=document.querySelector(`#exam${e}`);t.classList.add("active"),"題目"!==document.querySelector("#toggle").innerHTML?t.style.display="none":t.style.display="",currentQ=e}(parseInt(e.target.id.slice(6)))}))})),function(){function e(e,t){let r=[...e.parentElement.children].indexOf(e)+1;if(t)record[currentQ-1].push(r),record[currentQ-1].sort();else{let e=record[currentQ-1].indexOf(r);record[currentQ-1].splice(e,1)}let n=record.reduce(((e,t)=>e&&t.length),record[0].length),o=document.querySelector("#commit");o.disabled=!n,o.innerHTML=n?"提交":"未完成",o.className=n?"btn btn-success":"btn btn-light"}document.querySelectorAll("input[type=checkbox][name=options]").forEach((t=>{t.addEventListener("change",(t=>{let r=t.target,n=r.parentElement;r.checked?(n.classList.add("btn-primary"),n.classList.remove("btn-secondary"),r.nextElementSibling.className="far fa-check-square",e(n,!0)):(n.classList.remove("btn-primary"),n.classList.add("btn-secondary"),r.nextElementSibling.className="far fa-square",e(n,!1))}))}))}(),document.querySelector("#toggle").addEventListener("click",(function(e){let t=document.querySelector("#scene"),r=document.querySelector(".exam.active");"題目"===e.target.innerHTML?(e.target.innerHTML="圖片",t.object3D.visible=!0,r&&(r.style.display="none")):(e.target.innerHTML="題目",t.object3D.visible=!1,r&&(r.style.display=""))})),function(){function e(e){let t=record[e],r=document.querySelector(`#exam${e+1} > input[name=answer]`).value.split(",").map((e=>parseInt(e))),n=`<td>\n      ${o=t,c=r,Array.isArray(o)&&Array.isArray(c)&&o.length===c.length&&o.every(((e,t)=>e===c[t]))?'<i class="fas fa-check" style="width: 1.5rem; color: green"></i>':'<i class="fas fa-times" style="width: 1.5rem; color: red"></i>'} ${e+1}\n      </td>`;var o,c;let a=function(){let e=Array.from(new Set([...t,...r])).sort(),n="";return e.forEach(((o,c)=>{t.includes(o)&&r.includes(o)?n+=`<span style="color: green;">${String.fromCharCode(65+o-1)}</span>`:t.includes(o)?n+=`<span style="color: red; text-decoration:line-through;">${String.fromCharCode(65+o-1)}</span>`:n+=`<span style="color: red;">${String.fromCharCode(65+o-1)}</span>`,c<e.length-1&&(n+="、")})),`<td style="font-weight: bolder;">${n}</td>`}();return n+a}document.querySelector("#commit").addEventListener("click",(function(t){let r=new bootstrap.Modal(document.querySelector("#finisher")),n=document.querySelector("#result");document.querySelector("#finisher_name").innerHTML=studentName,document.querySelector("#finisher_id").innerHTML=studentID;for(let t=0;t<numQ;t++)n.innerHTML+=e(t);r.show()}))}()})();